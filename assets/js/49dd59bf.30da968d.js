"use strict";(self.webpackChunkbacalhau_docs=self.webpackChunkbacalhau_docs||[]).push([[5202],{3264:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var i=o(5893),l=o(1151);const s={sidebar_label:"Prolog Script",sidebar_position:4},t="Running a Prolog Script",a={id:"examples/workload-onboarding/Prolog-Hello-World/index",title:"Running a Prolog Script",description:"stars - badge-generator",source:"@site/docs/examples/workload-onboarding/Prolog-Hello-World/index.md",sourceDirName:"examples/workload-onboarding/Prolog-Hello-World",slug:"/examples/workload-onboarding/Prolog-Hello-World/",permalink:"/examples/workload-onboarding/Prolog-Hello-World/",draft:!1,unlisted:!1,editUrl:"https://github.com/bacalhau-project/docs.bacalhau.org/blob/main/docs/examples/workload-onboarding/Prolog-Hello-World/index.md",tags:[],version:"current",lastUpdatedAt:1702252086,formattedLastUpdatedAt:"Dec 10, 2023",sidebarPosition:4,frontMatter:{sidebar_label:"Prolog Script",sidebar_position:4},sidebar:"documentationSidebar",previous:{title:"Running-Jupyter-Notebook",permalink:"/examples/workload-onboarding/Running-Jupyter-Notebook/"},next:{title:"Python Custom Container",permalink:"/examples/workload-onboarding/Python-Custom-Container/"}},r={},d=[{value:"Introduction",id:"introduction",level:2},{value:"TD;LR",id:"tdlr",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Running Locally\u200b",id:"running-locally",level:2},{value:"Running a Bacalhau Job",id:"running-a-bacalhau-job",level:2},{value:"Structure of the Command",id:"structure-of-the-command",level:3},{value:"Checking the State of your Jobs",id:"checking-the-state-of-your-jobs",level:2},{value:"Viewing your Job Output",id:"viewing-your-job-output",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"running-a-prolog-script",children:"Running a Prolog Script"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/bacalhau-project/bacalhau",children:(0,i.jsx)(n.img,{src:"https://img.shields.io/github/stars/bacalhau-project/bacalhau?style=social",alt:"stars - badge-generator"})})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"Prolog is intended primarily as a declarative programming language: the program logic is expressed in terms of relations, represented as facts and rules. A computation is initiated by running a query over these relations.\nProlog is well-suited for specific tasks that benefit from rule-based logical queries such as searching databases, voice control systems, and filling templates."}),"\n",(0,i.jsx)(n.h2,{id:"tdlr",children:"TD;LR"}),"\n",(0,i.jsx)(n.p,{children:"A quick guide on how to run a hello world script on Bacalhau"}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.p,{children:["To get started, you need to install the Bacalhau client, see more information ",(0,i.jsx)(n.a,{href:"https://docs.bacalhau.org/getting-started/installation",children:"here"})]}),"\n",(0,i.jsx)(n.h2,{id:"running-locally",children:"Running Locally\u200b"}),"\n",(0,i.jsx)(n.p,{children:"To get started, install swipl"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\nsudo add-apt-repository ppa:swi-prolog/stable\nsudo apt-get update\nsudo apt-get install swi-prolog\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create a file called ",(0,i.jsx)(n.code,{children:"helloworld.pl"}),". The following script prints \u2018Hello World\u2019 to the stdout"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"%%writefile helloworld.pl\nhello_world :- write('Hello World'), nl, \n               halt.\n"})}),"\n",(0,i.jsx)(n.p,{children:"Running the script to print out the output"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\nswipl -q -s helloworld.pl -g hello_world\n"})}),"\n",(0,i.jsx)(n.p,{children:"After the script has run successfully locally we can now run it on Bacalhau."}),"\n",(0,i.jsx)(n.p,{children:"Before running it on Bacalhau we need to upload it to IPFS."}),"\n",(0,i.jsxs)(n.p,{children:["Using the ",(0,i.jsx)(n.code,{children:"IPFS cli"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"!wget https://dist.ipfs.io/go-ipfs/v0.4.2/go-ipfs_v0.4.2_linux-amd64.tar.gz\n!tar xvfz go-ipfs_v0.4.2_linux-amd64.tar.gz\n!mv go-ipfs/ipfs /usr/local/bin/ipfs\n!ipfs init\n!ipfs cat /ipfs/QmYwAPJzv5CZsnA625s3Xf2nemtYgPpHdWEz79ojWnPbdG/readme\n!ipfs config Addresses.Gateway /ip4/127.0.0.1/tcp/8082\n!ipfs config Addresses.API /ip4/127.0.0.1/tcp/5002\n!nohup ipfs daemon > startup.log &\n"})}),"\n",(0,i.jsx)(n.p,{children:"Run the command below to check if our script has been uploaded. This commmand outputs the CID."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"!ipfs add helloworld.pl\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Copy the CID of the file which in this case is ",(0,i.jsx)(n.code,{children:"QmYq9ipYf3vsj7iLv5C67BXZcpLHxZbvFAJbtj7aKN5qii"})]}),"\n",(0,i.jsxs)(n.p,{children:["Since the data uploaded To IPFS isn\u2019t pinned, we will need to do that manually. Check this information on how to pin your ",(0,i.jsx)(n.a,{href:"https://docs.bacalhau.org/data-ingestion/pin",children:"data"})," We recommend using ",(0,i.jsx)(n.a,{href:"https://nft.storage/",children:"NFT.Storage"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"running-a-bacalhau-job",children:"Running a Bacalhau Job"}),"\n",(0,i.jsx)(n.p,{children:"To submit a job, run the following Bacalhau command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash --out job_id\nbacalhau docker run \\\n-i ipfs://QmYq9ipYf3vsj7iLv5C67BXZcpLHxZbvFAJbtj7aKN5qii:/helloworld.pl \\\n--wait \\\n--id-only \\\nswipl \\\n -- swipl -q -s helloworld.pl -g hello_world\n"})}),"\n",(0,i.jsx)(n.h3,{id:"structure-of-the-command",children:"Structure of the Command"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-i: ipfs://< CID >:/< name-of-the-script >"}),": we will mount the script to the container using the -v flag"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Swipl"}),": flag"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-q"}),": running in quiet mode"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-s"}),": load file as a script in this case we want to run the script helloworld.pl"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"-g"}),": is the name of the function you want to execute in this case its hello_world"]}),"\n",(0,i.jsxs)(n.p,{children:["When a job is submitted, Bacalhau prints out the related ",(0,i.jsx)(n.code,{children:"job_id"}),". We store that in an environment variable so that we can reuse it later on."]}),"\n",(0,i.jsx)(n.h2,{id:"checking-the-state-of-your-jobs",children:"Checking the State of your Jobs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Job status"}),": You can check the status of the job using ",(0,i.jsx)(n.code,{children:"bacalhau list"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\nbacalhau list --id-filter ${JOB_ID} --wide\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When it says ",(0,i.jsx)(n.code,{children:"Published"})," or ",(0,i.jsx)(n.code,{children:"Completed"}),", that means the job is done, and we can get the results."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Job information"}),": You can find out more information about your job by using ",(0,i.jsx)(n.code,{children:"bacalhau describe"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\nbacalhau describe ${JOB_ID}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Job download"}),": You can download your job results directly by using ",(0,i.jsx)(n.code,{children:"bacalhau get"}),". Alternatively, you can choose to create a directory to store your results. In the command below, we created a directory and downloaded our job output to be stored in that directory."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\nrm -rf results && mkdir -p results\nbacalhau get $JOB_ID --output-dir results\n"})}),"\n",(0,i.jsx)(n.h2,{id:"viewing-your-job-output",children:"Viewing your Job Output"}),"\n",(0,i.jsx)(n.p,{children:"To view the file, run the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"%%bash\ncat results/stdout\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},1151:(e,n,o)=>{o.d(n,{Z:()=>a,a:()=>t});var i=o(7294);const l={},s=i.createContext(l);function t(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);