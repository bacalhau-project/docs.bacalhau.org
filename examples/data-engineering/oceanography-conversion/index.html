<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-examples/data-engineering/oceanography-conversion/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Oceanography - Data Conversion | Bacalhau Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.bacalhau.org//examples/data-engineering/oceanography-conversion/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Oceanography - Data Conversion | Bacalhau Docs"><meta data-rh="true" name="description" content="Oceanography data conversion with Bacalhau"><meta data-rh="true" property="og:description" content="Oceanography data conversion with Bacalhau"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.bacalhau.org//examples/data-engineering/oceanography-conversion/"><link data-rh="true" rel="alternate" href="https://docs.bacalhau.org//examples/data-engineering/oceanography-conversion/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.bacalhau.org//examples/data-engineering/oceanography-conversion/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://VLYBZRSZSU-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bacalhau Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bacalhau Docs Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D6NP6P151C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-D6NP6P151C",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Bacalhau Docs" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.bea87868.css">
<link rel="preload" href="/assets/js/runtime~main.f75d285a.js" as="script">
<link rel="preload" href="/assets/js/main.14ffb776.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Bacalhau Docs Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Bacalhau Docs Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Bacalhau Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/filecoin-project/bacalhau" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/about-bacalhau/architecture">About Bacalhau</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/installation">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/next-steps/parallel-workloads">Next Steps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/debugging">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/examples/">Examples</a><button aria-label="Toggle the collapsible sidebar category &#x27;Examples&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/data-ingestion/">Data Ingestion</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/workload-onboarding/">How To&#x27;s</a><button aria-label="Toggle the collapsible sidebar category &#x27;How To&#x27;s&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/examples/data-engineering/">Data Engineering</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data Engineering&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/examples/data-engineering/DuckDB/">DuckDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/examples/data-engineering/image-processing/">Simple Image Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/examples/data-engineering/simple-parallel-workloads/">Simple Parallel Workloads</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/examples/data-engineering/blockchain-etl/">Ethereum Blockchain Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/examples/data-engineering/csv-to-avro-or-parquet/">csv-to-avro-or-parquet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/examples/data-engineering/oceanography-conversion/">Oceanography - Data Conversion</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/model-inference/">Model Inference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Model Inference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/model-training/">Model Training</a><button aria-label="Toggle the collapsible sidebar category &#x27;Model Training&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/molecular-dynamics/">Molecular Dynamics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Molecular Dynamics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/examples/miscellaneous/">Miscellaneous</a><button aria-label="Toggle the collapsible sidebar category &#x27;Miscellaneous&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/running-node/quick-start">Running a Node</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/all-flags">CLI Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faqs">FAQs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/development">Development</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/community/style-guide">Community</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/examples/"><span itemprop="name">Examples</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/examples/data-engineering/"><span itemprop="name">Data Engineering</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Oceanography - Data Conversion</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Oceanography - Data Conversion</h1><p><a href="https://colab.research.google.com/github/bacalhau-project/examples/blob/main/data-engineering/oceanography-conversion/index.ipynb" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" class="img_ev3q"></a>
<a href="https://mybinder.org/v2/gh/bacalhau-project/examples/HEAD?labpath=data-engineering/oceanography-conversion/index.ipynb" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://mybinder.org/badge.svg" alt="Open In Binder" class="img_ev3q"></a></p><p>The Surface Ocean CO₂ Atlas (SOCAT) contains measurements of the <a href="https://en.wikipedia.org/wiki/Fugacity" target="_blank" rel="noopener noreferrer">fugacity</a> of CO2 in seawater around the globe. But to calculate how much carbon the ocean is taking up from the atmosphere, these measurements need to be converted to the partial pressure of CO2. We will convert the units by combining measurements of the surface temperature and fugacity.  Python libraries (xarray, pandas, numpy) and the pyseaflux package facilitate this process.</p><p>The goal of this notebook is to investigate the data and convert dockerize the workload so that it can be executed on the Bacalhau network, to take advantage of the distributed storage and compute resources.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><p>This example requires Docker. If you don&#x27;t have Docker installed, you can install it from <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">here</a>. Docker commands will not work on hosted notebooks like Google Colab, but the Bacalhau commands will.</p><p>Make sure you have the latest <code>bacalhau</code> client installed by following the <a href="/getting-started/installation">getting started instructions</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-data">The Data<a class="hash-link" href="#the-data" title="Direct link to heading">​</a></h2><p>The raw data is available on the <a href="https://www.socat.info/" target="_blank" rel="noopener noreferrer">SOCAT website</a>. We will use the <a href="https://www.socat.info/index.php/version-2021/" target="_blank" rel="noopener noreferrer">SOCATv2021</a> dataset in the &quot;Gridded&quot; format to perform this calculation. First, let&#x27;s take a quick look at some data:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">!command </span><span class="token operator">-</span><span class="token plain">v docker </span><span class="token operator">&gt;</span><span class="token operator">/</span><span class="token plain">dev</span><span class="token operator">/</span><span class="token plain">null </span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> echo </span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">2</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;I require docker but it&#x27;s not installed.  Aborting.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> exit </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">export BACALHAU_INSTALL_DIR</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> curl </span><span class="token operator">-</span><span class="token plain">sL https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token operator">//</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">bacalhau</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">org</span><span class="token operator">/</span><span class="token plain">install</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sh </span><span class="token operator">|</span><span class="token plain"> bash</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">path</span><span class="token operator">=</span><span class="token plain">!echo $PATH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">%</span><span class="token plain">env PATH</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Your system is linux_amd64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No BACALHAU detected. Installing fresh BACALHAU CLI...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Getting the latest BACALHAU CLI...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Installing v0.3.15 BACALHAU CLI...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Downloading https://github.com/filecoin-project/bacalhau/releases/download/v0.3.15/bacalhau_v0.3.15_linux_amd64.tar.gz ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Downloading sig file https://github.com/filecoin-project/bacalhau/releases/download/v0.3.15/bacalhau_v0.3.15_linux_amd64.tar.gz.signature.sha256 ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Verified OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Extracting tarball ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NOT verifying Bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bacalhau installed into . successfully.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Client Version: v0.3.15</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server Version: v0.3.15</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">env: PATH=./:/home/gitpod/.pyenv/versions/3.8.13/bin:/home/gitpod/.pyenv/libexec:/home/gitpod/.pyenv/plugins/python-build/bin:/home/gitpod/.pyenv/plugins/pyenv-virtualenv/bin:/home/gitpod/.pyenv/plugins/pyenv-update/bin:/home/gitpod/.pyenv/plugins/pyenv-installer/bin:/home/gitpod/.pyenv/plugins/pyenv-doctor/bin:/home/gitpod/.pyenv/shims:/ide/bin/remote-cli:/home/gitpod/.nix-profile/bin:/home/gitpod/.local/bin:/home/gitpod/.sdkman/candidates/maven/current/bin:/home/gitpod/.sdkman/candidates/java/current/bin:/home/gitpod/.sdkman/candidates/gradle/current/bin:/workspace/.cargo/bin:/home/gitpod/.rvm/gems/ruby-3.1.2/bin:/home/gitpod/.rvm/gems/ruby-3.1.2@global/bin:/home/gitpod/.rvm/rubies/ruby-3.1.2/bin:/home/gitpod/.pyenv/plugins/pyenv-virtualenv/shims:/home/gitpod/.pyenv/shims:/workspace/go/bin:/home/gitpod/.nix-profile/bin:/ide/bin/remote-cli:/home/gitpod/go/bin:/home/gitpod/go-packages/bin:/home/gitpod/.nvm/versions/node/v16.18.1/bin:/home/gitpod/.yarn/bin:/home/gitpod/.pnpm:/home/gitpod/.pyenv/bin:/workspace/.rvm/bin:/home/gitpod/.cargo/bin:/home/linuxbrew/.linuxbrew/bin:/home/linuxbrew/.linuxbrew/sbin/:/home/gitpod/.local/bin:/usr/games:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/home/gitpod/.nvm/versions/node/v16.18.1/bin:/home/gitpod/.rvm/bin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> -p inputs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> --output ./inputs/SOCATv2022_tracks_gridded_monthly.nc.zip https://www.socat.info/socat_files/v2022/SOCATv2022_tracks_gridded_monthly.nc.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> --output ./inputs/sst.mnmean.nc https://downloads.psl.noaa.gov/Datasets/noaa.oisst.v2/sst.mnmean.nc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">100 35.5M  100 35.5M    0     0  34.6M      0  0:00:01  0:00:01 --:--:-- 34.6M</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">100 60.8M  100 60.8M    0     0  14.6M      0  0:00:04  0:00:04 --:--:-- 14.6M</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next let&#x27;s write the requirements.txt and install the dependencies. This file will also be used by the Dockerfile to install the dependencies.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token operator">%</span><span class="token plain">writefile requirements</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Bottleneck</span><span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dask</span><span class="token operator">==</span><span class="token number">2022.2</span><span class="token number">.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fsspec</span><span class="token operator">==</span><span class="token number">2022.5</span><span class="token number">.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netCDF4</span><span class="token operator">==</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">numpy</span><span class="token operator">==</span><span class="token number">1.21</span><span class="token number">.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pandas</span><span class="token operator">==</span><span class="token number">1.3</span><span class="token number">.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip</span><span class="token operator">==</span><span class="token number">22.1</span><span class="token number">.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pyseaflux</span><span class="token operator">==</span><span class="token number">2.2</span><span class="token number">.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">scipy</span><span class="token operator">==</span><span class="token number">1.7</span><span class="token number">.3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">xarray</span><span class="token operator">==</span><span class="token number">0.20</span><span class="token number">.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">zarr</span><span class="token operator">&gt;=</span><span class="token number">2.0</span><span class="token number">.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Writing requirements.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -r requirements.txt </span><span class="token operator">&gt;</span><span class="token plain"> /dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> fsspec </span><span class="token comment" style="color:rgb(98, 114, 164)"># for reading remote files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> xarray </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> xr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> fsspec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./inputs/SOCATv2022_tracks_gridded_monthly.nc.zip&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> compression</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;zip&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">open_dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">xarray.Dataset {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dimensions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    xlon = 360 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ylat = 180 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    tmnth = 624 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bnds = 2 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">variables:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 xlon(xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xlon:units = degrees_east ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xlon:point_spacing = even ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xlon:axis = X ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xlon:modulo = 360.0 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        xlon:standard_name = longitude ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 ylat(ylat) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ylat:units = degrees_north ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ylat:point_spacing = even ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ylat:axis = Y ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ylat:standard_name = latitude ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datetime64[ns] tmnth(tmnth) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmnth:axis = T ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmnth:bounds = tmnth_bnds ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmnth:time_origin = 01-JAN-1970 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tmnth:standard_name = time ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    datetime64[ns] tmnth_bnds(tmnth, bnds) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 count_ncruise(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        count_ncruise:long_name = Number of cruises ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        count_ncruise:units = count ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        count_ncruise:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        count_ncruise:summary = Number of datasets containing observations in the grid cell ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 fco2_count_nobs(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_count_nobs:long_name = Number of fco2 obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_count_nobs:units = count ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_count_nobs:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_count_nobs:summary = Total number of observations in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_ave_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_weighted:long_name = fCO2 mean - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_weighted:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_weighted:summary = Mean of fco2 recomputed computed by calculating the arithmetic mean value for each cruise passing through the cell and then averaging these datasets. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_ave_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_unwtd:long_name = fCO2 mean - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_unwtd:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_ave_unwtd:summary = Arithmetic mean of all fco2 recomputed values found in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_min_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_min_unwtd:long_name = fCO2 min ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_min_unwtd:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_min_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_min_unwtd:summary = Minimum value of fco2 recomputed observed in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_max_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_max_unwtd:long_name = fCO2 max ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_max_unwtd:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_max_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_std_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_weighted:long_name = fCO2 std dev - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_weighted:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_weighted:summary = A weighted standard deviation of fco2 recomputed computed to account for the differing </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">variance estimates for each cruise passing through the cell. The statistical technique is </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">described at See http://wapedia.mobi/en/Weighted_mean#7. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 fco2_std_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_unwtd:long_name = fCO2 std dev - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_unwtd:units = uatm ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        fco2_std_unwtd:summary = The standard deviation of fco2 recomputed computed from the unweighted mean. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 sst_count_nobs(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_count_nobs:long_name = Number of valid sst obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_count_nobs:units = count ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_count_nobs:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_count_nobs:summary = Total number of observations in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_ave_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_weighted:long_name = SST mean - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_weighted:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_weighted:summary = Mean of sst computed by calculating the arithmetic mean value for each cruise passing through the cell and then averaging these datasets. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_ave_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_unwtd:long_name = SST mean - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_unwtd:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_ave_unwtd:summary = Arithmetic mean of all sst values found in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_min_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_min_unwtd:long_name = SST min ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_min_unwtd:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_min_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_min_unwtd:summary = Minimum value of sst observed in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_max_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_max_unwtd:long_name = SST max ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_max_unwtd:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_max_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_std_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_weighted:long_name = SST std dev - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_weighted:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_weighted:summary = A weighted standard deviation of sst computed to account for the differing </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">variance estimates for each cruise passing through the cell. The statistical technique is </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">described at See http://wapedia.mobi/en/Weighted_mean#7. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 sst_std_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_unwtd:long_name = SST std dev - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_unwtd:units = degrees C ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        sst_std_unwtd:summary = The standard deviation of sst computed from the unweighted mean. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float64 salinity_count_nobs(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_count_nobs:long_name = Number of valid salinity obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_count_nobs:units = count ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_count_nobs:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_count_nobs:summary = Total number of observations in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_ave_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_weighted:long_name = Salinity mean - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_weighted:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_weighted:summary = Mean of salinity computed by calculating the arithmetic mean value for each cruise passing through the cell and then averaging these datasets. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_ave_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_unwtd:long_name = Salinity mean - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_unwtd:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_ave_unwtd:summary = Arithmetic mean of all salinity values found in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_min_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_min_unwtd:long_name = Salinity min ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_min_unwtd:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_min_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_min_unwtd:summary = Minimum value of salinity observed in the grid cell. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_max_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_max_unwtd:long_name = Salinity max ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_max_unwtd:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_max_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_std_weighted(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_weighted:long_name = Salinity std dev - per cruise weighted ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_weighted:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_weighted:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_weighted:summary = A weighted standard deviation of salinity computed to account for the differing </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">variance estimates for each cruise passing through the cell. The statistical technique is </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">described at See http://wapedia.mobi/en/Weighted_mean#7. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 salinity_std_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_unwtd:long_name = Salinity std dev - unweighted all obs ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_unwtd:units = PSU ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        salinity_std_unwtd:summary = The standard deviation of salinity computed from the unweighted mean. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 lat_offset_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lat_offset_unwtd:long_name = Latitude average offset from cell center ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lat_offset_unwtd:units = Deg N ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lat_offset_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lat_offset_unwtd:summary = The arithmetic average of latitude offsets from the grid cell center for all observations in </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">the grid cell. The value of this offset can vary from -0.5 to 0.5. A value of zero indicates </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">that the computed fco2 mean values are representative of the grid cell center position. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    float32 lon_offset_unwtd(tmnth, ylat, xlon) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lon_offset_unwtd:long_name = Longitude average offset from cell center ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lon_offset_unwtd:units = Deg E ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lon_offset_unwtd:history = From SOCAT_ABCD_data_for_gridding ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        lon_offset_unwtd:summary = The arithmetic average of longitude offsets from the grid cell center for all observations in </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">the grid cell. The value of this offset can vary from -0.5 to 0.5. A value of zero indicates </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">that the computed fco2 mean values are representative of the grid cell center position. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// global attributes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :history = PyFerret V7.63 (optimized) 31-May-22 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :Conventions = CF-1.6 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :SOCAT_Notes = SOCAT gridded v2022 26-May-2022 ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :title = SOCAT gridded v2022 Monthly 1x1 degree gridded dataset ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :summary = Surface Ocean Carbon Atlas (SOCAT) Gridded (binned) SOCAT observations, with a spatial </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">grid of 1x1 degree and monthly in time. The gridded fields are computed using only SOCAT </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">datasets with QC flags of A through D and SOCAT data points flagged with WOCE flag values of 2. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :references = http://www.socat.info/ ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    :caution = NO INTERPOLATION WAS PERFORMED. SIGNIFICANT BIASES ARE PRESENT IN THESE GRIDDED RESULTS DUE TO THE </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ARBITRARY AND SPARSE LOCATIONS OF DATA VALUES IN BOTH SPACE AND TIME. ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">time_slice </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2010&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2020&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># select a decade</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">res </span><span class="token operator">=</span><span class="token plain"> ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sst_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tmnth</span><span class="token operator">=</span><span class="token plain">time_slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dim</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;tmnth&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># average over time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">res</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># plot the result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">---------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AttributeError                            Traceback (most recent call last)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cell In [8], line 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      1 time_slice = slice(&quot;2010&quot;, &quot;2020&quot;) # select a decade</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      2 res = ds[&#x27;sst_ave_unwtd&#x27;].sel(tmnth=time_slice).mean(dim=&#x27;tmnth&#x27;) # average over time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----&gt; 3 res.plot()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File ~/.pyenv/versions/3.8.13/lib/python3.8/site-packages/xarray/plot/plot.py:862, in _PlotMethods.__call__(self, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    861 def __call__(self, **kwargs):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 862     return plot(self._da, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File ~/.pyenv/versions/3.8.13/lib/python3.8/site-packages/xarray/plot/plot.py:330, in plot(darray, row, col, col_wrap, ax, hue, rtol, subplot_kws, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    326     plotfunc = hist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    328 kwargs[&quot;ax&quot;] = ax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 330 return plotfunc(darray, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File ~/.pyenv/versions/3.8.13/lib/python3.8/site-packages/xarray/plot/plot.py:1174, in _plot2d.&lt;locals&gt;.newplotfunc(darray, x, y, figsize, size, aspect, ax, row, col, col_wrap, xincrease, yincrease, add_colorbar, add_labels, vmin, vmax, cmap, center, robust, extend, levels, infer_intervals, colors, subplot_kws, cbar_ax, cbar_kwargs, xscale, yscale, xticks, yticks, xlim, ylim, norm, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1170 yplt, ylab_extra = _resolve_intervals_2dplot(yval, plotfunc.__name__)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1172 _ensure_plottable(xplt, yplt, zval)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-&gt; 1174 cmap_params, cbar_kwargs = _process_cmap_cbar_kwargs(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1175     plotfunc,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1176     zval.data,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1177     **locals(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1178     _is_facetgrid=kwargs.pop(&quot;_is_facetgrid&quot;, False),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1179 )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1181 if &quot;contour&quot; in plotfunc.__name__:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1182     # extend is a keyword argument only for contour and contourf, but</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1183     # passing it to the colorbar is sufficient for imshow and</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1184     # pcolormesh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1185     kwargs[&quot;extend&quot;] = cmap_params[&quot;extend&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File ~/.pyenv/versions/3.8.13/lib/python3.8/site-packages/xarray/plot/utils.py:905, in _process_cmap_cbar_kwargs(func, data, cmap, colors, cbar_kwargs, levels, _is_facetgrid, **kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    903 cmap_kwargs.update((a, kwargs[a]) for a in cmap_args if a in kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    904 if not _is_facetgrid:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 905     cmap_params = _determine_cmap_params(**cmap_kwargs)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    906 else:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    907     cmap_params = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    908         k: cmap_kwargs[k]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    909         for k in [&quot;vmin&quot;, &quot;vmax&quot;, &quot;cmap&quot;, &quot;extend&quot;, &quot;levels&quot;, &quot;norm&quot;]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    910     }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File ~/.pyenv/versions/3.8.13/lib/python3.8/site-packages/xarray/plot/utils.py:185, in _determine_cmap_params(plot_data, vmin, vmax, cmap, center, robust, extend, levels, filled, norm, _is_facetgrid)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    159 def _determine_cmap_params(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    160     plot_data,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    161     vmin=None,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   (...)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    170     _is_facetgrid=False,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    171 ):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    172     &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    173     Use some heuristics to set good defaults for colorbar and range.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    174 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   (...)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    183         Use depends on the type of the plotting function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    184     &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 185     mpl = plt.matplotlib</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    187     if isinstance(levels, Iterable):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    188         levels = sorted(levels)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;matplotlib&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can see that the dataset contains lat-long coordinates, the date, and a series of seawater measurements. Above you can see a plot of the average surface sea temperature (sst) between 2010-2020, where recording buoys and boats have travelled.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-task---large-scale-data-conversion">The Task - Large Scale Data Conversion<a class="hash-link" href="#the-task---large-scale-data-conversion" title="Direct link to heading">​</a></h2><p>The goal of this notebook is to convert the data from fugacity of CO2 (fCO2) to partial pressure of CO2 (pCO2). This is a common task in oceanography, and is performed by combining the measurements of the surface temperature and fugacity. The conversion is performed by the <a href="https://seaflux.readthedocs.io/en/latest/api.html?highlight=fCO2_to_pCO2#pyseaflux.fco2_pco2_conversion.fCO2_to_pCO2" target="_blank" rel="noopener noreferrer">pyseaflux</a> package.</p><p>To execute this workload on the Bacalhau network we need to perform three steps:</p><ol><li>Upload the data to IPFS</li><li>Create a docker image with the code and dependencies</li><li>Run the docker image on the Bacalhau network using the IPFS data</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upload-the-data-to-ipfs">Upload the Data to IPFS<a class="hash-link" href="#upload-the-data-to-ipfs" title="Direct link to heading">​</a></h3><p>The first step is to upload the data to IPFS. The simplest way to do this is to use a third party service to &quot;pin&quot; data to the IPFS network, to ensure that the data exists and is available. To do this you need an account with a pinning service like <a href="https://web3.storage/" target="_blank" rel="noopener noreferrer">web3.storage</a> or <a href="https://pinata.cloud/" target="_blank" rel="noopener noreferrer">Pinata</a>. Once registered you can use their UI or API or SDKs to upload files.</p><p>For the purposes of this example I:</p><ol><li>Downloaded the latest monthly data from the <a href="https://www.socat.info/" target="_blank" rel="noopener noreferrer">SOCAT website</a></li><li>Downloaded the latest long-term global sea surface temperature data from <a href="https://downloads.psl.noaa.gov/Datasets/noaa.oisst.v2/sst.mnmean.nc" target="_blank" rel="noopener noreferrer">NOAA</a> - information about that dataset can be found <a href="https://psl.noaa.gov/data/gridded/data.noaa.oisst.v2.highres.html" target="_blank" rel="noopener noreferrer">here</a>.</li><li>Pinned the data to IPFS</li></ol><p>This resulted in the IPFS CID of <code>bafybeidunikexxu5qtuwc7eosjpuw6a75lxo7j5ezf3zurv52vbrmqwf6y</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-docker-image-to-process-the-data">Create a Docker Image to Process the Data<a class="hash-link" href="#create-a-docker-image-to-process-the-data" title="Direct link to heading">​</a></h3><p>Next we will create the docker image that will process the data. The docker image will contain the code and dependencies needed to perform the conversion. This code originated with <a href="https://github.com/lgloege/bacalhau_socat_test" target="_blank" rel="noopener noreferrer">lgloege</a> via <a href="https://github.com/wesfloyd/bacalhau_socat_test/" target="_blank" rel="noopener noreferrer">wesfloyd</a>. Thank you! 🤗</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>For more information about working with custom containers, see the <a href="/examples/workload-onboarding/custom-containers/">custom containers example</a>.</p></div></div><p>The key thing to watch out for here is the paths to the data. I&#x27;m using the default bacalhau output directory <code>/outputs</code> to write my data to. And the input data is mounted to the <code>/inputs</code> directory. But as you will see in a moment, web3.storage has added another <code>input</code> directory that we need to account for.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token operator">%</span><span class="token plain">writefile main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> fsspec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> xarray </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> xr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> pyseaflux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">lon_360_to_180</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> lonVar</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    lonVar </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lon&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> lonVar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> lonVar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">assign_coords</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">lonVar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">lonVar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">180</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> </span><span class="token number">360</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">180</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sortby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lonVar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dtype</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;float32&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> order</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;C&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">center_dates</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># start and end date</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    start_date </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">strftime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%Y-%m&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end_date </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">strftime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%Y-%m&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># monthly dates centered on 15th of each month</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    dates </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">date_range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">start</span><span class="token operator">=</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">start_date</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">-01T00:00:00.000000000&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          end</span><span class="token operator">=</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">end_date</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">-01T00:00:00.000000000&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          freq</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;MS&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">timedelta64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">14</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;D&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">assign</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">time</span><span class="token operator">=</span><span class="token plain">dates</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">get_and_process_sst</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># get noaa sst</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> url </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/inputs/sst.mnmean.nc&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> fsspec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">open_dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> lon_360_to_180</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> center_dates</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> ds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">get_and_process_socat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> url </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/inputs/SOCATv2022_tracks_gridded_monthly.nc.zip&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> fsspec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> compression</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;zip&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">open_dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">fp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;xlon&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lon&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ylat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;lat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tmnth&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;time&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds </span><span class="token operator">=</span><span class="token plain"> center_dates</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> ds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Load SST and SOCAT data&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_sst </span><span class="token operator">=</span><span class="token plain"> get_and_process_sst</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_socat </span><span class="token operator">=</span><span class="token plain"> get_and_process_socat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Merge datasets together&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    time_slice </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1981-12&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2022-05&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_out </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">merge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ds_sst</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sst&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">time</span><span class="token operator">=</span><span class="token plain">time_slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                       ds_socat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">time</span><span class="token operator">=</span><span class="token plain">time_slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Calculate pco2 from fco2&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;pco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">apply_ufunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pyseaflux</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fCO2_to_pCO2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;sst&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Add metadata&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;pco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;units&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;uatm&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;pco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;notes&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;calculated using&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                               </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;NOAA OI SST V2&quot;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                               </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;and pyseaflux package&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Save data&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ds_out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_zarr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/processed.zarr&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> shutil</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    shutil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">make_archive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/outputs/processed.zarr&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;zip&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/processed.zarr&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Zarr file written to disk, job completed successfully&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> __name__ </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;__main__&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token operator">%</span><span class="token plain">writefile Dockerfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FROM python</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">slim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN apt</span><span class="token operator">-</span><span class="token plain">get update </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token plain"> apt</span><span class="token operator">-</span><span class="token plain">get </span><span class="token operator">-</span><span class="token plain">y upgrade \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token plain"> apt</span><span class="token operator">-</span><span class="token plain">get install </span><span class="token operator">-</span><span class="token plain">y </span><span class="token operator">-</span><span class="token operator">-</span><span class="token plain">no</span><span class="token operator">-</span><span class="token plain">install</span><span class="token operator">-</span><span class="token plain">recommends \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    g</span><span class="token operator">+</span><span class="token operator">+</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token plain"> rm </span><span class="token operator">-</span><span class="token plain">rf </span><span class="token operator">/</span><span class="token plain">var</span><span class="token operator">/</span><span class="token plain">lib</span><span class="token operator">/</span><span class="token plain">apt</span><span class="token operator">/</span><span class="token plain">lists</span><span class="token operator">/</span><span class="token operator">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WORKDIR </span><span class="token operator">/</span><span class="token plain">project</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">/</span><span class="token plain">requirements</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">txt </span><span class="token operator">/</span><span class="token plain">project</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUN pip3 install </span><span class="token operator">-</span><span class="token plain">r requirements</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">/</span><span class="token plain">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">py </span><span class="token operator">/</span><span class="token plain">project</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CMD </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;python&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;main.py&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># docker buildx build --platform linux/amd64,linux/arm64 --push -t ghcr.io/bacalhau-project/examples/socat:0.0.11 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-container-locally">Test the Container Locally<a class="hash-link" href="#test-the-container-locally" title="Direct link to heading">​</a></h3><p>Before we upload the container to the Bacalhau network, we should test it locally to make sure it works.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -v </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">pwd</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain">/inputs:/inputs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -v </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">pwd</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain">/outputs:/outputs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ghcr.io/bacalhau-project/examples/socat:0.0.11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-a-bacalhau-job">Run a Bacalhau Job<a class="hash-link" href="#run-a-bacalhau-job" title="Direct link to heading">​</a></h3><p>Now that we have the data in IPFS and the docker image pushed, we can run a job on the Bacalhau network.</p><p>I find it useful to first run a simple test with a known working container to ensure the data is located in the place I expect, because some storage providers add their own opinions. E.g. web3.storage wraps the directory uploads in a top level directory.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf stdout stderr volumes shards</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bacalhau </span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        --download </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        --inputs bafybeidunikexxu5qtuwc7eosjpuw6a75lxo7j5ezf3zurv52vbrmqwf6y </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ubuntu -- </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> /inputs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then I like to run a simple test with my custom container ...</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf stdout stderr volumes shards</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bacalhau </span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --inputs bafybeidunikexxu5qtuwc7eosjpuw6a75lxo7j5ezf3zurv52vbrmqwf6y </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    --download </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ghcr.io/bacalhau-project/examples/socat:0.0.11 -- </span><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -la /inputs/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And finally let&#x27;s run the full job. This time I will not download the data immediately, because the job takes around 100s. And it takes another few minutes to download the results. The commands are below, but you will need to wait until the job completes before they work.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bacalhau </span><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> run </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        --inputs bafybeidunikexxu5qtuwc7eosjpuw6a75lxo7j5ezf3zurv52vbrmqwf6y </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        --id-only </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        --wait </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ghcr.io/bacalhau-project/examples/socat:0.0.11 -- python main.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token operator">%</span><span class="token plain">env JOB_ID</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain">job_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-results">Get Results<a class="hash-link" href="#get-results" title="Direct link to heading">​</a></h2><p>Now let&#x27;s download and display the result from the results directory. We can use the <code>bacalhau get</code> command to download the results from the output data volume. The <code>--output-dir</code> argument specifies the directory to download the results to.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">rm</span><span class="token plain"> -rf results</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> -p ./results </span><span class="token comment" style="color:rgb(98, 114, 164)"># Temporary directory to store the results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bacalhau get --output-dir ./results </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${JOB_ID}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Download the results</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> ./results/stdout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> ./results/volumes/outputs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> shutil</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shutil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">unpack_archive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./results/volumes/outputs/processed.zarr.zip&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./results/volumes/outputs/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> xarray </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> xr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ds </span><span class="token operator">=</span><span class="token plain"> xr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">open_dataset</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./results/volumes/outputs/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> engine</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;zarr&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ds</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;pco2_ave_unwtd&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dim</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;time&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ul><li><a href="https://www.socat.info/" target="_blank" rel="noopener noreferrer">https://www.socat.info/</a></li><li><a href="https://seaflux.readthedocs.io/en/latest/api.html?highlight=fCO2_to_pCO2#pyseaflux.fco2_pco2_conversion.fCO2_to_pCO2" target="_blank" rel="noopener noreferrer">https://seaflux.readthedocs.io/en/latest/api.html?highlight=fCO2_to_pCO2#pyseaflux.fco2_pco2_conversion.fCO2_to_pCO2</a></li><li><a href="https://github.com/lgloege/bacalhau_socat_test/blob/main/main.py" target="_blank" rel="noopener noreferrer">https://github.com/lgloege/bacalhau_socat_test/blob/main/main.py</a></li><li><a href="https://github.com/wesfloyd/bacalhau_socat_test" target="_blank" rel="noopener noreferrer">https://github.com/wesfloyd/bacalhau_socat_test</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bacalhau-project/docs.bacalhau.org/blob/main/docs/examples/data-engineering/oceanography-conversion/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/examples/data-engineering/csv-to-avro-or-parquet/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">csv-to-avro-or-parquet</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/examples/model-inference/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Model Inference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#the-data" class="table-of-contents__link toc-highlight">The Data</a></li><li><a href="#the-task---large-scale-data-conversion" class="table-of-contents__link toc-highlight">The Task - Large Scale Data Conversion</a><ul><li><a href="#upload-the-data-to-ipfs" class="table-of-contents__link toc-highlight">Upload the Data to IPFS</a></li><li><a href="#create-a-docker-image-to-process-the-data" class="table-of-contents__link toc-highlight">Create a Docker Image to Process the Data</a></li><li><a href="#test-the-container-locally" class="table-of-contents__link toc-highlight">Test the Container Locally</a></li><li><a href="#run-a-bacalhau-job" class="table-of-contents__link toc-highlight">Run a Bacalhau Job</a></li></ul></li><li><a href="#get-results" class="table-of-contents__link toc-highlight">Get Results</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/getting-started/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/">About Bacalhau</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/bacalhau" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/BacalhauProject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/filecoin-project/bacalhau" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Bacalhau, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f75d285a.js"></script>
<script src="/assets/js/main.14ffb776.js"></script>
</body>
</html>